<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">

<dom-module id="members-material">
  <template>
    <style is="custom-style">
      #cards {
        text-align: center;
      }
      paper-card {
        width: 250px;
        margin: 16px;
        min-height: 300px;
      }
      .inherit {
        color: inherit;
        background-color: inherit;
      }
      @media screen and (max-width: 729px) {
        paper-card {
          margin: 16px 0;
        }
      }
      paper-card
      .avatar {
        display: inline-block;
        height: 64px;
        width: 64px;
        border-radius: 50%;
        color: white;
        line-height: 64px;
        font-size: 30px;
        text-align: center;
      }
	  paper-button.link {
	    color: var(--paper-gray-800);
      text-decoration: none;
	  }
	  paper-button.link:hover {
	    background-color: var(--paper-indigo-100);
	  }
	  .title-text {
	  	background-color: rgba(200, 200, 200, 0.3) !important;
	  	color: var(--paper-pink-400) !important;
	  	border-radius: 0 20px 0 0 !important;
	  }
	  iron-image {
		  width: 100%;
	  }
    paper-card {
       --paper-card-header-color: white;
    }
    </style>

    <iron-ajax auto url="getUsersInfo.php" handle-as="json" last-response="{{data}}"></iron-ajax>
    <div id="cards">
    <template id="cardstemplate" is="dom-repeat" items="{{data}}">
      <paper-card heading="{{item.nick}}" image="{{item.img}}">  <!--style$="--paper-card-header-color: {{item.col}}" image="{{item.img}}">-->
        <div class="card-actions">
          <a href="http://{{item.name}}.serben.tk" target="{{item.name}}" class="inherit">
            <paper-button class="link">Vai al sito</paper-button>
          </a>
          <a href="{{item.link}}" target="{{item.nick}}" class="inherit">
            <paper-button class="link">Vai al profilo Steam</paper-button>
          </a>
        </div>
      </paper-card>
<!--      <paper-card class="fancy">
        <div class="card-content">
          <div class="avatar" data-name="{{item.name}}">
            <template is="dom-if" if="{{existsLogo(item.link)}}">
              <img src="logos/{{item.link}}.png" />
            </template>
            <template is="dom-if" if="{{!existsLogo(item.link)}}">
              {{getInitials(item.name)}}
            </template>
          </div>
          <div class="title">
            <div class="medium">{{item.nick}}</div>
            <div class="small">{{item.name}}</div>
          </div>
        </div>
        <div class="card-actions">
          <paper-button on-tap="goLink">
            <href>{{item.link}}</href>
            Vai al sito
          </paper-button>
        </div>
      </paper-card>-->
    </template>
    </div>
  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'members-material',

        existsLogo: function(link) {
          var http = new XMLHttpRequest();
          http.onreadystatechange = function() {
            if (http.readyState === 4) {
              return (http.status === 200) || (window.location.href.indefOf('http') === -1);
            }
          };
          http.open('HEAD', 'logos/' + link + '.png', true);
        },

        getInitials: function(name) {
          var arr = name.split(' ');
          return arr[0][0] + arr[arr.length - 1][0];
        },

        ready: function() {
          this.$.cardstemplate.addEventListener('dom-change', function() {
/*            for (var i = 0; i < avatars.length; i++) {
              console.log(avatars[i]);
              avatars[i].setAttribute("--paper-card-header-color", "white !important");
            }
              var colors = this.getColorFromName(avatars[i].dataset.name);
              avatars[i].style.color = colors.color;
              avatars[i].style.background = colors.background;
            }
            var cards = document.getElementsByTagName('paper-card');
            for (var i = 0; i < cards.length; i++) { console.log(cards[i].getAttribute('aria-label')); }
            */
          });
        }
      });
    })();
  </script>
</dom-module>
