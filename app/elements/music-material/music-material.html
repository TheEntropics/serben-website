<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/paper-audio-player/paper-audio-player.html">

<dom-module id="music-material">
  <template>
    <style is="custom-style">
    </style>

    <iron-ajax auto url="getSongs.php" handle-as="json" last-response="{{data}}" on-response="test"></iron-ajax>
    <template is="dom-repeat" items="{{data}}">
      <paper-audio-player src="{{item.link}}" title="{{getTitle(item)}}" color="#3f51b5" />
    </template>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'music-material',
        getTitle: function(song) {
          var title = song.title ? song.title : song.filename;
          if (song.album)
            title += ' - ' + song.album;
          if (song.year)
            title += ' (' + song.year + ')';
          if (song.artist)
            title += ' - ' + song.artist;
          return title;
        },
        test: function(data) {
          console.log(data.detail.response);
        }
      });
    })();
  </script>
</dom-module>
